(()=>{"use strict";function t(t,e,n=!1,o){const c=document.querySelector(".todos-list"),a=document.createElement("li"),d=document.createElement("input");d.type="checkbox",d.name="todo-check",d.checked=n,d.classList.add("todo-check");const i=document.createElement("div");i.classList.add("title"),i.textContent=t.title;const s=document.createElement("i");s.classList.add("fa-solid","fa-circle-info");const l=document.createElement("i");switch(l.classList.add("fa-solid","fa-flag"),t.priority){case"low":l.style.color="blue";break;case"medium":l.style.color="var(--medium)";break;case"high":l.style.color="red"}const r=document.createElement("i");r.classList.add("fa-solid","fa-pen",`${o}`);const u=document.createElement("i");u.classList.add("fa-solid","fa-trash",`${o}`);const m=document.createElement("div");m.classList.add("details");const p=document.createElement("div");p.classList.add("details-content");const h=document.createElement("div");h.textContent=t.description||"There's no description";const y=document.createElement("div"),[f,g,v]=t.dueDate.split("-");y.textContent=`Due date : ${v}.${g}.${f}`,h.classList.add("description"),y.classList.add("dueDate"),p.appendChild(h),p.appendChild(y),m.appendChild(p),a.appendChild(d),a.appendChild(i),a.appendChild(s),a.appendChild(l),a.appendChild(r),a.appendChild(u),a.appendChild(m),a.dataset.index=e,a.classList.add("todo-element"),c.appendChild(a)}const e=document.querySelector(".modal"),n=document.querySelector(".overlay"),o=document.getElementById("todo-submit-btn");function c(t){return`${t.getFullYear()}-${`${t.getMonth()+1}`.padStart(2,"0")}-${`${t.getDate()}`.padStart(2,"0")}`}function a(t){!function(){const t=document.getElementById("todo-date"),e=(new Date).getFullYear(),n=(new Date).getMonth()<10?`0${(new Date).getMonth()+1}`:(new Date).getMonth(),o=(new Date).getDate()<10?`0${(new Date).getDate()}`:(new Date).getDate();t.min=`${e}-${n}-${o}`}(),o.textContent=`${t}`,n.classList.add("active"),e.classList.add("active")}function d(){n.classList.remove("active"),e.classList.remove("active")}function i(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function s(t,e){t.classList.toggle("active"),e.classList.toggle("active"),e.classList.toggle("mobile-closed")}async function l(){const t=await fetch("http://localhost:3000/PROJECTS");(await t.json()).forEach((t=>{!function(t,e){const n=document.querySelector(".projects-list"),o=document.createElement("li"),c=document.createElement("button");c.classList.add("project-name"),o.dataset.index=e,c.textContent=t,o.appendChild(c),n.appendChild(o)}(t.projectName,t.id)}))}async function r(t){const e=t.target.dataset.index,n=document.querySelector(".active-project-header");let o=`http://localhost:3000/PROJECTS/${e}`;await fetch(o,{method:"DELETE"}),document.getElementById("remove-project-btn").classList.remove("active"),async function(t){let e=`http://localhost:3000/TODOS?project=${t}`;const n=await fetch(e);(await n.json()).forEach((async t=>{let e=`http://localhost:3000/TODOS/${t.id}`;await fetch(e,{method:"DELETE"})}))}(n.textContent),n.textContent="Your TODOS",p(),u()}async function u(){const t=document.querySelector(".projects-list");for(;t.hasChildNodes();)t.removeChild(t.firstChild);l()}async function m(){let e=`http://localhost:3000/TODOS?project=${document.querySelector(".active-project-header").textContent}`;const n=await fetch(e);(await n.json()).forEach((e=>{t(e,e.id,e.isChecked)}))}async function p(){const t=document.querySelector(".todos-list");for(;t.hasChildNodes();)t.removeChild(t.firstChild);m()}function h(){const t=document.getElementById("add-project-btn"),e=document.querySelector(".main-content-menu"),n=document.createElement("input");n.id="add-project-input",n.setAttribute("autocomplete","off"),n.setAttribute("maxlength","20"),n.addEventListener("keydown",(async function(o){if("Enter"===o.key){const o=document.querySelector(".projects-list");e.removeChild(n),e.appendChild(t);const c=document.createElement("li"),a=document.createElement("button");a.classList.add("project-name"),a.textContent=n.value;const d={projectName:n.value};await fetch("http://localhost:3000/PROJECTS",{method:"POST",body:JSON.stringify(d),headers:{"Content-Type":"application/json"}}),c.appendChild(a),o.appendChild(c),u()}})),e.removeChild(t),e.appendChild(n),n.focus()}const y=async function(e){e.preventDefault();const n=document.getElementById("todo-submit-btn").textContent,o={project:`${document.querySelector(".active-project-header").textContent}`,title:document.getElementById("todo-title").value,dueDate:document.getElementById("todo-date").value,priority:document.getElementById("todo-priority").value,description:document.getElementById("todo-description").value,isChecked:!1},c=e.target.dataset.formIndex;"Submit"===n?async function(e){await fetch("http://localhost:3000/TODOS",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});const n=await fetch("http://localhost:3000/TODOS");t(e,(await n.json()).length)}(o):async function(t){const e={project:`${document.querySelector(".active-project-header").textContent}`,title:document.getElementById("todo-title").value,dueDate:document.getElementById("todo-date").value,priority:document.getElementById("todo-priority").value,description:document.getElementById("todo-description").value};await fetch(`http://localhost:3000/TODOS/${t}`,{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}),p()}(c),d()};async function f(t){const e=document.querySelector(".todos-list"),n=document.getElementById("todo-form"),o=t.target.parentNode.dataset.index;if(t.target.classList.contains("fa-circle-info")){const e=t.target.parentNode.querySelector(".details"),n=t.target.previousSibling;e.classList.toggle("active"),n.classList.toggle("active")}t.target.classList.contains("fa-trash")&&(e.removeChild(t.target.parentNode),async function(t){let e=`http://localhost:3000/TODOS/${t}`;await fetch(e,{method:"DELETE"})}(o)),t.target.classList.contains("fa-pen")&&(n.dataset.formIndex=o,function(t){let e=document.getElementById("todo-title"),n=document.getElementById("todo-date"),o=document.getElementById("todo-priority"),c=document.getElementById("todo-description"),a=document.querySelector(`[data-index="${t}"]`);const d=a.querySelector(".title");switch(e.value=d.textContent,a.querySelector(".fa-flag").style.color){case"blue":o.value="low";break;case"var(--medium)":o.value="medium";break;case"red":o.value="high"}const i=a.querySelector(".description");c.textContent=i.textContent;const s=i.nextElementSibling,[l,r,u]=s.textContent.slice(11).split(".");n.value=`${u}-${r}-${l}`}(o),a("Save")),t.target.classList.contains("todo-check")&&async function(t){const e=t.target.checked,n=t.target.parentNode.dataset.index,o={isChecked:e};await fetch(`http://localhost:3000/TODOS/${n}`,{method:"PATCH",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}})}(t)}const g=document.querySelector(".main-content-todos"),v=document.getElementById("remove-project-btn"),C=document.querySelector(".projects-list"),E=document.getElementById("add-todo-btn");function L(t){"All"==t.target.textContent&&S(t,b),"7 Days"==t.target.textContent&&S(t,x),"Today"==t.target.textContent&&S(t,D)}function S(t,e){[...t.target.closest("ul").children].forEach((t=>{t.classList.remove("active")})),t.target.parentNode.classList.add("active"),e()}async function x(){i(document.querySelector(".todos-list"));const e=await fetch("http://localhost:3000/TODOS?_sort=dueDate&_order=asc"),n=await e.json(),o=new Date;o.setDate((new Date).getDate()+7);const a=c(o);n.forEach((e=>{e.dueDate<a&&t(e,e.id,e.isChecked,"active")}))}async function D(){i(document.querySelector(".todos-list"));const e=await fetch("http://localhost:3000/TODOS?_sort=dueDate&_order=asc"),n=await e.json(),o=c(new Date);n.forEach((e=>{e.dueDate==o&&t(e,e.id,e.isChecked,"active")}))}async function b(){i(document.querySelector(".todos-list"));const e=await fetch("http://localhost:3000/TODOS");(await e.json()).forEach((e=>{t(e,e.id,e.isChecked,"active")}))}const j=function(t){if(t.target.classList.contains("open-projects-list-btn")&&C.classList.toggle("active"),t.target.classList.contains("project-name")){const e=document.querySelector(".active-project-header");if(E.classList.add("active"),e&&e.textContent!=t.target.textContent)e.textContent=t.target.textContent,"Your TODOS"==e.textContent?v.classList.remove("active"):v.classList.add("active"),v.dataset.index=t.target.parentNode.dataset.index,p();else{"Your TODOS"==t.target.textContent?v.classList.remove("active"):v.classList.add("active"),g.innerHTML="";const e=document.createElement("h2");e.classList.add("active-project-header");const n=document.createElement("ul");n.classList.add("todos-list"),n.addEventListener("click",f),e.textContent=t.target.textContent,g.appendChild(e),g.appendChild(n),p()}}if("inbox"==t.target.id){E.classList.remove("active"),v.classList.remove("active");const t=document.querySelector(".active-project-header");if(!t)return;g.removeChild(t);const e=document.createElement("ul");e.classList.add("inbox-nav");const n=document.createElement("li"),o=document.createElement("li"),c=document.createElement("li"),a=document.createElement("button"),d=document.createElement("button"),i=document.createElement("button");a.textContent="All",d.textContent="Today",i.textContent="7 Days",n.appendChild(a),o.appendChild(d),c.appendChild(i),e.appendChild(n),e.appendChild(o),e.appendChild(c),e.addEventListener("click",L),b(),g.insertBefore(e,g.firstChild)}};(()=>{const t=document.getElementById("add-todo-btn"),e=document.getElementById("close-btn"),n=document.getElementById("add-project-btn"),o=document.getElementById("remove-project-btn"),c=document.getElementById("todo-form"),i=document.getElementById("todo-description"),u=document.querySelector(".burger-menu"),p=document.querySelector(".main-content-menu"),g=document.querySelector(".todos-list");t.addEventListener("click",(()=>{c.reset(),i.textContent="",p.classList.contains("active")&&s(u,p),a("Submit")})),e.addEventListener("click",d),n.addEventListener("click",h),o.addEventListener("click",r),c.addEventListener("submit",y),p.addEventListener("click",j),g.addEventListener("click",f),u.addEventListener("click",(()=>{s(u,p)})),window.addEventListener("DOMContentLoaded",(()=>{m(),l()}))})()})();